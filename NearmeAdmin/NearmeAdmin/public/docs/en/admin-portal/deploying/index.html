<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.41" />
    <meta name="description" content="Documentation for Nearme">
<meta name="author" content="Fernando Mendoza">

    <link rel="shortcut icon" href="/docs/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="/docs/images/favicon.png" type="image/x-icon" />
    <title>Deploying :: Documentation for Nearme</title>
    
    
    <link href="/docs/css/nucleus.css?1529702475" rel="stylesheet">
    <link href="/docs/css/font-awesome.min.css?1529702475" rel="stylesheet">
    <link href="/docs/css/hybrid.css?1529702475" rel="stylesheet">
    <link href="/docs/css/featherlight.min.css?1529702475" rel="stylesheet">
    <link href="/docs/css/perfect-scrollbar.min.css?1529702475" rel="stylesheet">
    <link href="/docs/css/auto-complete.css?1529702475" rel="stylesheet">
    <link href="/docs/css/theme.css?1529702475" rel="stylesheet">
    <link href="/docs/css/hugo-theme.css?1529702475" rel="stylesheet">
    
      <link href="/docs/css/theme-blue.css?1529702475" rel="stylesheet">
    

    <script src="/docs/js/jquery-2.x.min.js?1529702475"></script>
    
    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{ 
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/docs/en/admin-portal/deploying/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">
  <img height="50" src="/docs/images/logo.png" />
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fa fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fa fa-close"></i></span>
</div>

<script type="text/javascript" src="/docs/js/lunr.min.js?1529702475"></script>
<script type="text/javascript" src="/docs/js/auto-complete.js?1529702475"></script>
<script type="text/javascript">
    
        var baseurl = "\/docs\/en";
    
</script>
<script type="text/javascript" src="/docs/js/search.js?1529702475"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/docs/en/admin-portal/" title="Admin Portal" class="dd-item 
        parent
        
        
        ">
      <a href="/docs/en/admin-portal/">
          <b>1. </b>Admin Portal
          
            <i class="fa fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/docs/en/admin-portal/requirements/" title="Requirements" class="dd-item 
        
        
        
        ">
      <a href="/docs/en/admin-portal/requirements/">
          Requirements
          
            <i class="fa fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/en/admin-portal/installation/" title="Installation" class="dd-item 
        
        
        
        ">
      <a href="/docs/en/admin-portal/installation/">
          Installation
          
            <i class="fa fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/en/admin-portal/configuration/" title="Configuration" class="dd-item 
        
        
        
        ">
      <a href="/docs/en/admin-portal/configuration/">
          Configuration
          
            <i class="fa fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/en/admin-portal/deploying/" title="Deploying" class="dd-item 
        parent
        active
        
        ">
      <a href="/docs/en/admin-portal/deploying/">
          Deploying
          
            <i class="fa fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs/en/mobile-app/" title="Mobile app" class="dd-item 
        
        
        
        ">
      <a href="/docs/en/mobile-app/">
          <b>2. </b>Mobile app
          
            <i class="fa fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/docs/en/mobile-app/requirements/" title="Requirements" class="dd-item 
        
        
        
        ">
      <a href="/docs/en/mobile-app/requirements/">
          Requirements
          
            <i class="fa fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/en/mobile-app/configuration/" title="Configuration" class="dd-item 
        
        
        
        ">
      <a href="/docs/en/mobile-app/configuration/">
          Configuration
          
            <i class="fa fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/en/mobile-app/deploying/" title="Deploying" class="dd-item 
        
        
        
        ">
      <a href="/docs/en/mobile-app/deploying/">
          Deploying
          
            <i class="fa fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs/en/release-notes/" title="Changelog" class="dd-item 
        
        
        
        ">
      <a href="/docs/en/release-notes/">
          <b></b>Changelog
          
            <i class="fa fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fa fa-fw fa-language"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="/docs/en/admin-portal/deploying/" selected>English</option>
                    
                  
              
                  
              
          
              
              
                  
              
                  
                    
                    
                      <option id="es" value="/docs/es/admin-portal/deploying/">Espa√±ol</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
       
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fa fa-fw fa-history"></i> Clear History</a></li>         
      
      </ul>
    </section>
    
    <section id="footer">
      <center>
    <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fa fa-heart"></i></a> from <a href="https://quanlabs.com">Quanlabs</a>
</center>
    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fa fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/docs/en/'>Nearme. Ionic 2/3 Starter for Location Based Apps</a> > <a href='/docs/en/admin-portal/'>Admin Portal</a> > Deploying
          
         
          
         
          
           
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#configure-git-repository">Configure Git repository</a></li>
<li><a href="#setup-environment-variables">Setup Environment Variables</a></li>
</ul></li>
<li><a href="#setup-google-maps">Setup Google Maps</a></li>
<li><a href="#setup-mailgun">Setup Mailgun</a></li>
<li><a href="#setup-push-notifications">Setup push notifications</a>
<ul>
<li><a href="#setup-notifications-for-android">Setup notifications for Android</a></li>
<li><a href="#setup-ios-notifications">Setup iOS notifications</a></li>
</ul></li>
<li><a href="#configure-ssl-with-let-s-encrypt-optional">Configure SSL with Let&rsquo;s Encrypt (Optional)</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>Deploying</h1>
          

        




<p>The previous instructions were executed on the server side. Now the following commands should be executed in your local machine where the admin portal source code is.</p>

<h3 id="configure-git-repository">Configure Git repository</h3>

<p>Initialize a new repository.</p>

<pre><code class="language-bash">mycomputer@NearmeAdmin:~$ git init
</code></pre>

<p>Add all the files to the repository.</p>

<pre><code class="language-bash">mycomputer@NearmeAdmin:~$ git add .
</code></pre>

<p>Commit changes made to the repository.</p>

<pre><code class="language-bash">mycomputer@NearmeAdmin:~$ git commit -m &quot;Added Nearme Admin Panel source code.&quot;
</code></pre>

<p>Add a remote called <em>dokku</em> where the code will be <em>pushed</em>. Assuming that our IP is <code>46.101.4.76</code> and the app name is <code>nearme</code>, execute the following:</p>

<pre><code class="language-bash">mycomputer@NearmeAdmin:~$ git remote add dokku dokku@46.101.4.76:nearme
</code></pre>

<h3 id="setup-environment-variables">Setup Environment Variables</h3>

<p>Since Dokku is based on Docker, we will use the environment variables to setup the web portal before proceeding with the deployment.</p>

<p>Open the <em>Dockerfile</em> located at the root of the web portal code. In this file we have set all the environment variables that we can configure. At the moment the only required to install the web portal is <code>SERVER_URL</code>, which we should set to the URL that we configure in the DNS step. For example:</p>

<pre><code class="language-bash">ENV SERVER_URL http://nearme.quanlabs.com
</code></pre>

<p>We will see later the other variables in more detail.</p>

<p>Save the changes made to the Dockerfile and confirm the changes to the repository. Once again:</p>

<pre><code class="language-bash">mycomputer@NearmeAdmin:~$ git add .
</code></pre>

<p>Confirm changes made to the repository.</p>

<pre><code class="language-bash">mycomputer@NearmeAdmin:~$ git commit -m &quot;Updated Dockerfile&quot;
</code></pre>

<p>Now, we are ready to push the changes to the server.</p>

<pre><code class="language-bash">mycomputer@NearmeAdmin:~$ git push dokku master
</code></pre>

<p>Wait a few minutes and you should see a success message that the application has been successfully deployed.</p>

<p>If everything went well, open the server URL in your web browser (in our case <a href="http://nearme.quanlabs.com">http://nearme.quanlabs.com</a>) and the login page should appear.</p>

<p>Finally, open the installation page available in the path <code>/install</code> and fill out the form to create the admin user.</p>

<p>That is all! Next we will see how to configure some aspects to guarantee the correct functioning of the web portal.</p>

<h2 id="setup-google-maps">Setup Google Maps</h2>

<p>Now we need to create an API key in order to use Google Maps. We can generate this key in a couple of minutes following <a href="https://developers.google.com/maps/documentation/javascript/get-api-key">this guide</a>.</p>

<p>Having the key ready, open the Dockerfile and update the variable <code>GOOGLE_MAPS_API_KEY</code>.</p>

<pre><code>ENV GOOGLE_MAPS_API_KEY AIzaXXXXXXXXXXXXXXXXXXXXXXXXXXX
</code></pre>

<h2 id="setup-mailgun">Setup Mailgun</h2>

<p>Mailgun allows us to send emails through a flexible API and without the need to install extra software on our server.</p>

<p>It is necessary to configure Mailgun so that the password recovery function via email works correctly.</p>

<p>First go to the <a href="https://www.mailgun.com/">Mailgun</a> and create a new account.</p>

<p>In the admin panel add a new domain. It is recommended to use the same domain of the app. After adding the domain you will have to verify it. Follow the steps described in the Mailgun portal.</p>

<p>Then in the details of the domain you will find the <code>API Key</code>. Open the Dockerfile and update the Mailgun variables. Example:</p>

<pre><code class="language-bash">ENV MAILGUN_API_KEY key-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
ENV MAILGUN_DOMAIN quanlabs.com
ENV MAILGUN_FROM_ADDRESS 'QuanLabs &lt;dev@quanlabs.com&gt;'
ENV MAILGUN_TO_ADDRESS 'dev@quanlabs.com'
</code></pre>

<h2 id="setup-push-notifications">Setup push notifications</h2>

<p>In the web portal we have the ability to send push notifications to users. For this to work on Android devices we must first generate the <code>Sender ID</code> and the <code>API Key</code> in Firebase Console. For iOS devices, we must generate the certificates in Apple Developer Portal.</p>

<h3 id="setup-notifications-for-android">Setup notifications for Android</h3>

<ol>
<li>In your web browser, visit the <a href="https://console.firebase.google.com">Firebase console</a> and sign in with your Google account.</li>
<li>Create a new project.</li>
<li>Click on the gear icon in the upper left and select the option <em>Project Settings</em>.</li>
<li>Click on the <em>Cloud Messaging</em> tab.</li>
<li>Copy the <em>Legacy Server Key</em> and the <em>Sender ID</em>.</li>
<li>Open the Dockerfile and update the variables <code>PUSH_ANDROID_SENDER_ID</code> and<code>PUSH_ANDROID_API_KEY</code>.
Example:</li>
</ol>

<pre><code class="language-bash">ENV PUSH_ANDROID_SENDER_ID XXXXXXXXXXX
ENV PUSH_ANDROID_API_KEY AIzaXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
</code></pre>

<h3 id="setup-ios-notifications">Setup iOS notifications</h3>

<p>To follow the steps below it is necessary to have an Apple developer account and a Mac. If we meet these requirements we have to do the following from the developer portal:</p>

<ol>
<li>Create a new App ID with the notification service enabled.</li>
<li>Create the notification certificate in development and production mode.</li>
<li>Download and install the certificates on your computer.</li>
<li>Export the certificates to P12 format.</li>
<li>Copy the .P12 certificates to the <code>/push</code> folder located in admin portal source code.</li>
</ol>

<p><a href="http://recordit.co/kFpQR4Vo4R"><img src="/docs/images/setup-push-ios.gif" alt="Setup iOS Push Notifications" /></a></p>

<p>You can click on the image to see the full video.</p>

<div class="notices note" ><p>When creating the App ID it&rsquo;s important to select the option with the explicit suffix. Also it&rsquo;s recommended to set this ID with our domain in reverse order. For example in our case it would be <code>com.quanlabs.nearme</code></p>
</div>


<p>Open the Dockerfile and update the variable <code>PUSH_IOS_BUNDLE_ID</code> with the same App ID that we configured in the Apple portal.</p>

<pre><code class="language-bash">ENV PUSH_IOS_BUNDLE_ID com.quanlabs.nearme
</code></pre>

<h2 id="configure-ssl-with-let-s-encrypt-optional">Configure SSL with Let&rsquo;s Encrypt (Optional)</h2>

<p>This step is optional but it is worth it doing it to ensure that communications between the server and the mobile application are encrypted.</p>

<p>First we enter via SSH to the server and execute the following to install the Let&rsquo;s Encrypt plugin.</p>

<pre><code class="language-bash">server@root:~$ dokku plugin:install https://github.com/dokku/dokku-letsencrypt.git
</code></pre>

<p>Encript the app.</p>

<pre><code class="language-bash">server@root:~$ dokku letsencrypt nearme
</code></pre>

<p>And finally open the Dockerfile and adjust the value of the variable <code>SERVER_URL</code> to<code>https</code></p>

<pre><code class="language-bash">ENV SERVER_URL https://nearme.quanlabs.com
</code></pre>

<div class="notices note" ><p>Every time we make a change in the source code (Ex .: Modify the Dockerfile) we have to push the code to reflect the changes in the server as follows: add the files to the repository, confirm the changes and finally push them with the command <code>git push</code></p>
</div>



<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


        
            <a class="nav nav-prev" href="/docs/en/admin-portal/configuration/" title="Configuration"> <i class="fa fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="/docs/en/mobile-app/" title="Mobile app" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
        
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/docs/js/clipboard.min.js?1529702475"></script>
    <script src="/docs/js/perfect-scrollbar.min.js?1529702475"></script>
    <script src="/docs/js/perfect-scrollbar.jquery.min.js?1529702475"></script>
    <script src="/docs/js/jquery.sticky.js?1529702475"></script>
    <script src="/docs/js/featherlight.min.js?1529702475"></script>
    <script src="/docs/js/html5shiv-printshiv.min.js?1529702475"></script>
    <script src="/docs/js/highlight.pack.js?1529702475"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/docs/js/modernizr.custom.71422.js?1529702475"></script>
    <script src="/docs/js/learn.js?1529702475"></script>
    <script src="/docs/js/hugo-learn.js?1529702475"></script>

    <link href="/docs/mermaid/mermaid.css?1529702475" type="text/css" rel="stylesheet" />
    <script src="/docs/mermaid/mermaid.js?1529702475"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-105947713-1', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
